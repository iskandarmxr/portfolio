<%# Admin Testimonials List %>
<% content_for :title, "Testimonials" %>

<div class="page-header">
  <div class="header-left">
    <h1>Testimonials</h1>
    <p class="page-subtitle"><%= @testimonials.count %> testimonials</p>
  </div>
  <div class="header-actions">
    <a href="<%= new_admin_testimonial_path %>" class="btn-accent">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 5v14M5 12h14"/>
      </svg>
      <span>Add Testimonial</span>
    </a>
  </div>
</div>

<% if @testimonials.any? %>
  <div class="glass-card data-table">
    <table>
      <thead>
        <tr>
          <th class="col-drag"></th>
          <th>Author</th>
          <th>Testimonial</th>
          <th>Rating</th>
          <th>Featured</th>
          <th class="col-actions">Actions</th>
        </tr>
      </thead>
      <tbody class="sortable-list">
        <% @testimonials.each do |testimonial| %>
          <tr data-id="<%= testimonial.id %>">
            <td class="col-drag">
              <span class="drag-handle">⋮⋮</span>
            </td>
            <td>
              <strong><%= testimonial.author_name %></strong>
              <% if testimonial.author_title.present? || testimonial.author_company.present? %>
                <span class="cell-subtitle">
                  <%= [testimonial.author_title, testimonial.author_company].compact.join(' at ') %>
                </span>
              <% end %>
            </td>
            <td>
              <span class="cell-subtitle"><%= truncate(testimonial.content, length: 80) %></span>
            </td>
            <td>
              <span style="color: #f59e0b;"><%= testimonial.stars %></span>
            </td>
            <td>
              <%= button_to toggle_featured_admin_testimonial_path(testimonial), method: :patch, class: "toggle-btn #{testimonial.featured? ? 'active' : ''}", title: testimonial.featured? ? 'Unfeature' : 'Feature' do %>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="<%= testimonial.featured? ? 'currentColor' : 'none' %>" stroke="currentColor" stroke-width="2">
                  <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
              <% end %>
            </td>
            <td class="col-actions">
              <div class="action-buttons">
                <a href="<%= edit_admin_testimonial_path(testimonial) %>" class="action-btn" title="Edit">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                  </svg>
                </a>
                <%= button_to admin_testimonial_path(testimonial), method: :delete, class: "action-btn danger", data: { confirm: "Delete this testimonial?" } do %>
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                  </svg>
                <% end %>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <div class="empty-state glass-card">
    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
    </svg>
    <p>No testimonials added yet</p>
    <a href="<%= new_admin_testimonial_path %>" class="btn-accent">Add your first testimonial</a>
  </div>
<% end %>
